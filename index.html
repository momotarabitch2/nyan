<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>è¨€ã„ãŸã„ã“ã¨ã‚‚è¨€ãˆãªã„ã“ã‚“ãªä¸–ã®ä¸­ã«ã‚ƒ</title>
  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gray-50 flex flex-col items-center p-6">
  <h1 class="text-3xl font-bold mb-6">ğŸ¾ è¨€ã„ãŸã„ã“ã¨ã‚‚è¨€ãˆãªã„ã“ã‚“ãªä¸–ã®ä¸­ã«ã‚ƒ ğŸ¾</h1>

  <div class="w-full max-w-xl space-y-4">
    <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ -->
    <label for="src" class="block font-medium">äººé–“èªã˜ã‚ƒè¨€ãˆãªã„ã“ã¨:</label>
    <textarea id="src" class="w-full p-3 border rounded-lg shadow-sm focus:outline-none focus:ring" rows="6" placeholder="ã“ã“ã«ç§˜å¯†ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›"></textarea>

    <!-- å¤‰æ›ãƒœã‚¿ãƒ³ -->
    <button id="convert" class="px-4 py-2 rounded-lg bg-indigo-500 text-white shadow hover:bg-indigo-600 transition flex items-center gap-2 justify-center">
      ğŸ¾ <span>ãƒã‚³èªã«å¤‰æ›</span> ğŸ¾
    </button>

    <!-- å‡ºåŠ›ã‚¨ãƒªã‚¢ -->
    <label for="dst" class="block font-medium">å¤‰æ›çµæœ:</label>
    <textarea id="dst" class="w-full p-3 border rounded-lg shadow-sm bg-gray-100" rows="6" readonly></textarea>

    <!-- ãƒ„ã‚¤ãƒ¼ãƒˆãƒœã‚¿ãƒ³ -->
    <a id="tweet" href="#" target="_blank" class="block text-center px-4 py-2 rounded-lg border shadow pointer-events-none opacity-40 bg-sky-500 text-white flex items-center gap-2 justify-center">
      ğŸ¾ <span>ãƒã‚³èªã§ã¤ã„ãƒ¼ã¨ã™ã‚‹</span> ğŸ¾
    </a>

    <p class="text-xs text-gray-500">â€» ãƒ„ã‚¤ãƒ¼ãƒˆã¯å…¬é–‹ã•ã‚Œã¾ã™ã€‚çŒ«èªã§ã‚‚å†…å®¹ã®æ©Ÿå¯†æ€§ã¯ä¿è¨¼ã•ã‚Œã¾ã›ã‚“ã€‚</p>
  </div>

  <script>
    // çŒ«èªãƒ¦ãƒ‹ãƒƒãƒˆå€™è£œ
    const catUnits = ["ã«ã‚ƒ", "ã«ã‚ƒãƒ¼", "ã«ã‚ƒã‚“", "ã«ã‚ƒã€œ", "ã«ã‚ƒã«ã‚ƒ", "ã«ã‚ƒãƒ¼ã‚“"];
    function randomCat() {
      return catUnits[Math.floor(Math.random() * catUnits.length)];
    }

    // 1 è¡Œã‚’åŒç­‰æ–‡å­—æ•°ãƒ¬ãƒ™ãƒ«ã®çŒ«èªã¸å¤‰æ›
    function catifyLine(line) {
      const punctuationMatch = line.match(/[ã€‚ï¼!ï¼Ÿ?]$/);
      const punctuation = punctuationMatch ? punctuationMatch[0] : "";
      // å¥èª­ç‚¹ãƒ»ç©ºç™½ã‚’é™¤ã„ãŸæ–‡å­—æ•°ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé•·ã•ã¨ã¿ãªã™
      const coreLen = line.replace(/[^\p{L}\p{N}]/gu, "").length || 1; // 0 ã‚’é¿ã‘ã‚‹ (Unicode-aware)
      let out = "";
      while (out.length < coreLen) {
        out += randomCat();
      }
      return out + punctuation;
    }

    function toCat(text) {
      return text.split("\n").map(catifyLine).join("\n");
    }

    // UI ã‚¤ãƒ™ãƒ³ãƒˆ
    document.getElementById('convert').addEventListener('click', () => {
      const src = document.getElementById('src').value;
      const cat = toCat(src);
      const dst = document.getElementById('dst');
      dst.value = cat;

      // ãƒ„ã‚¤ãƒ¼ãƒˆãƒªãƒ³ã‚¯æ›´æ–°
      const hashtag = "\n\n#ãªã‚“ã ãƒã‚³ã‹ ã«ã‚ƒãƒ¼ã‚“.jp";
      const tweetText = cat + hashtag;
      const tweetBtn = document.getElementById('tweet');
      tweetBtn.href = 'https://twitter.com/intent/tweet?text=' + encodeURIComponent(tweetText);
      tweetBtn.classList.remove('pointer-events-none', 'opacity-40');
    });
  </script>
</body>
</html>
